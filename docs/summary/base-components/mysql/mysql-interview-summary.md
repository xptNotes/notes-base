# MySQL面试汇总



# 索引

## 如何创建索引?





## 判断是否走索引?

### OR情况

MySQL查询中使用`OR`并不意味着索引一定会失效。索引是否被使用取决于多个因素，包括查询的具体结构、涉及的列以及这些列上索引的存在与定义。在某些情况下，使用`OR`可能导致查询优化器决定不使用索引， 而在其他情况下，它仍然可以利用索引进行查询。以下是一些影响索引使用的情况：

1. **复合索引中的列顺序**：如果查询条件使用`OR`连接的列都是复合索引的一部分，并且遵循索引中的列顺序，那么MySQL可能会使用索引。
2. **索引合并优化**：在某些情况下，MySQL可以使用索引合并优化策略，即结合多个索引来满足使用`OR`连接的查询条件。
3. **查询选择性**：如果`OR`条件中的每个部分都非常选择性（即匹配的行数很少），那么即使使用`OR`，MySQL也可能使用索引。
4. **全表扫描可能更高效**：如果使用`OR`的查询条件匹配了表中的大部分行，那么全表扫描可能比使用索引更高效，因此MySQL查询优化器可能选择不使用索引。
5. **类型转换和函数**：如果`OR`连接的条件中涉及到对索引列的类型转换或者使用了函数，那么索引可能不会被使用。

总的来说，是否使用索引以及如何使用索引是由MySQL的查询优化器决定的，它会基于统计信息和成本估算来选择最佳的执行计划。如果担心`OR`操作符导致索引失效，可以使用`EXPLAIN`语句来查看查询的执行计划，了解是否有索引被使用以及如何使用。此外，通过调整查询结构或创建适当的索引，可以优化查询性能，使其更有可能利用索引

要保证使用`OR`时一定使用索引，需要确保查询优化器认为使用索引是最优选择。这通常涉及到确保查询中的每个部分都能够匹配到有效的索引，并且这些索引能够提供比全表扫描更好的性能。以下是一些确保使用`OR`时索引被使用的策略：

1. **使用覆盖索引**：确保`OR`查询中的所有列都包含在一个或多个索引中。例如，如果有一个索引`idx_name`覆盖了`first_name`和`last_name`字段，那么以下查询可能会使用该索引：

   ```sql
   sql
   
    代码解读
   复制代码SELECT first_name, last_name FROM users WHERE first_name = 'Alice' OR last_name = 'Smith';
   ```

2. **索引合并**：如果`OR`查询的每个条件都对应一个索引，MySQL可能会通过索引合并优化来使用这些索引。例如，如果`first_name`和`last_name`各自有索引，以下查询可能会使用索引合并：

   ```sql
   sql
   
    代码解读
   复制代码SELECT * FROM users WHERE first_name = 'Alice' OR last_name = 'Smith';
   ```

3. **使用`UNION`或`UNION ALL`**：如果无法确保`OR`查询直接使用索引，可以将查询分解为多个使用`UNION`或`UNION ALL`的子查询，每个子查询分别使用索引。例如：

   ```sql
   sql
   
    代码解读
   复制代码SELECT * FROM users WHERE first_name = 'Alice'
   UNION ALL
   SELECT * FROM users WHERE last_name = 'Smith';
   ```

4. **强制索引**：在某些情况下，可以使用`FORCE INDEX`语句来强制查询使用特定的索引。这应该谨慎使用，因为它覆盖了MySQL查询优化器的决策。例如：

   ```sql
   sql
   
    代码解读
   复制代码SELECT * FROM users FORCE INDEX (idx_first_name) WHERE first_name = 'Alice' OR last_name = 'Smith';
   ```

请注意，即使采取了上述措施，仍然不能百分百保证`OR`查询一定会使用索引，因为MySQL查询优化器会基于统计信息和成本模型来做出决定。如果它判断使用索引的成本高于全表扫描，它可能会选择不使用索引。 因此，最好的做法是使用`EXPLAIN`语句来查看查询的执行计划，并根据实际情况调整查询和索引策略



## B+Tree数据结构

### 数据结构





### 千万级数据层高估算





